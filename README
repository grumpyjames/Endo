This particular piece of code is, currently, absolutely horrible. It also doesn't obey the specification given in the problem. If you use it, you're an idiot.